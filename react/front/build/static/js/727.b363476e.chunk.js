"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[727],{727:function(e,r,n){n.r(r),n.d(r,{SeparateAudioVideoHandler:function(){return d},default:function(){return i}});var t=n(214),o=n(861),a=n(459),u=n.n(a),c=n(791),s=n(184);function i(e){var r=e.videoInfo,n=e.audio,t=e.onLoadingComplete;return null!==r&&void 0!==r&&r.hasAudio||!n?(console.log("VideoHandler"),(0,s.jsx)("video",{className:"max-h-screen",controls:!0,autoPlay:!1,muted:!0,loop:!0,preload:"auto",playsInline:!0,draggable:!1,onLoadStart:t,children:(0,s.jsx)("source",{"data-src":r.url,src:r.url,type:"video/mp4"})})):(0,s.jsx)(d,{videoUrl:r.url,audioUrl:n,onLoadingComplete:t})}function d(e){var r=e.videoUrl,n=e.audioUrl,a=e.onLoadingComplete,i=(0,c.useRef)(null);return(0,c.useEffect)((function(){function e(e){return a.apply(this,arguments)}function a(){return(a=(0,o.Z)((0,t.Z)().mark((function e(r){var n,o,a,c,s,i;return(0,t.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(r);case 3:return e.next=5,e.sent.blob();case 5:return n=e.sent,e.next=8,n.arrayBuffer();case 8:return o=e.sent,a=new Int8Array(o),c=u().mp4.probe.tracks(a),s=c[0].codec,i='video/mp4; codecs="'.concat(s,'"'),e.abrupt("return",{arrayBuffer:o,mimeCodec:i});case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",{error:e.t0});case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function c(){return(c=(0,o.Z)((0,t.Z)().mark((function o(){var a,u,c,s,d,l,p,f,m,v,h,b,y,x;return(0,t.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=[],"MediaSource"in window){t.next=4;break}return console.error("MediaSource unsupported"),t.abrupt("return");case 4:if(null!==i.current){t.next=7;break}return console.error("videoRef not set"),t.abrupt("return");case 7:u=0,c=[r,n];case 8:if(!(u<c.length)){t.next=21;break}return s=c[u],t.next=12,e(s);case 12:d=t.sent,l=d.arrayBuffer,p=d.mimeCodec,f=d.error,console.log({mimeCodec:p,error:f,url:s}),f||!p?console.error(f):MediaSource.isTypeSupported(p)?a.push({arrayBuffer:l,mimeCodec:p}):console.error("Unsupported MIME type or codec: ".concat(p));case 18:u++,t.next=8;break;case 21:if(0!==a.length){t.next=24;break}return console.error("No supported sources"),t.abrupt("return");case 24:for(m=new MediaSource,i.current.src=URL.createObjectURL(m),v=a.length,h=function(){var e;0===(v-=1)&&(m.endOfStream(),null===(e=i.current)||void 0===e||e.play())},b=function(){var e=x[y],r=e.arrayBuffer,n=e.mimeCodec;m.addEventListener("sourceopen",(function(){var e=m.addSourceBuffer(n);e.addEventListener("updateend",h),e.appendBuffer(r)}))},y=0,x=a;y<x.length;y++)b();case 30:case"end":return t.stop()}}),o)})))).apply(this,arguments)}!function(){c.apply(this,arguments)}()}),[n,r]),(0,s.jsx)("video",{className:"max-h-screen",ref:i,controls:!0,autoPlay:!1,muted:!0,loop:!0,preload:"auto",playsInline:!0,draggable:!1,onLoadStart:a})}}}]);
//# sourceMappingURL=727.b363476e.chunk.js.map
"use strict";(self.webpackChunkfront=self.webpackChunkfront||[]).push([[727],{5727:function(e,r,n){n.r(r),n.d(r,{SeparateAudioVideoHandler:function(){return h},default:function(){return p}});var t=n(5861),a=n(8214),o=n(6420),u=n(608),c=n(5459),s=n.n(c),i=n(2791),d=n(184);function p(e){var r=e.videoInfo,n=e.audio,t=e.onLoadingComplete;return null!==r&&void 0!==r&&r.hasAudio||!n?(0,d.jsx)("video",{className:"max-h-screen",controls:!0,autoPlay:!1,muted:!0,loop:!0,preload:"auto",playsInline:!0,draggable:!1,onLoadStart:t,children:(0,d.jsx)("source",{"data-src":r.url,src:r.url,type:"video/mp4"})}):(0,d.jsx)(h,{videoUrl:r.url,audioUrl:n,onLoadingComplete:t})}function f(e){return l.apply(this,arguments)}function l(){return(l=(0,u.Z)((0,a.Z)().mark((function e(r){var n,t;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,o.Z)(fetch(r).then((function(e){if(null===(null===e||void 0===e?void 0:e.body))throw new Error("response null, no video");return e.body.getReader()})));case 3:n=e.sent;case 4:return e.next=7,(0,o.Z)(n.read());case 7:if(!(t=e.sent).done){e.next=10;break}return e.abrupt("break",14);case 10:return e.next=12,t.value;case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),console.error(e.t0);case 19:return e.abrupt("return");case 20:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function v(e){var r=s().mp4.probe.tracks(e)[0].codec;return'video/mp4; codecs="'.concat(r,'"')}function x(e){return b.apply(this,arguments)}function b(){return(b=(0,t.Z)((0,a.Z)().mark((function e(r){var n,t,o,u;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(r);case 3:return e.next=5,e.sent.blob();case 5:return n=e.sent,e.next=8,n.arrayBuffer();case 8:if(t=e.sent,o=new Int8Array(t),u=v(o),MediaSource.isTypeSupported(u)){e.next=13;break}throw new Error("Unsupported MIME type or codec: ".concat(u));case 13:return e.abrupt("return",{arrayBuffer:t,mimeCodec:u});case 16:return e.prev=16,e.t0=e.catch(0),e.abrupt("return",{error:e.t0});case 19:case"end":return e.stop()}}),e,null,[[0,16]])})))).apply(this,arguments)}function h(e){var r=e.videoUrl,n=e.audioUrl,o=e.onLoadingComplete,u=(0,i.useRef)(null);return(0,i.useEffect)((function(){function e(){return e=(0,t.Z)((0,a.Z)().mark((function e(){var o,c,s,i,d,p,l;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("MediaSource"in window){e.next=3;break}return console.error("MediaSource unsupported"),e.abrupt("return");case 3:if(null!==u.current){e.next=6;break}return console.error("videoRef not set"),e.abrupt("return");case 6:return o=new MediaSource,c=f(r),o.addEventListener("sourceopen",(0,t.Z)((0,a.Z)().mark((function e(){var r,n,s,i,d;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.next();case 2:if(!(n=e.sent).done){e.next=5;break}throw new Error("no first segment");case 5:s=v(n.value),i=o.addSourceBuffer(s),d=function(){var e=(0,t.Z)((0,a.Z)().mark((function e(){var r,n;return(0,a.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.next();case 2:(r=e.sent).done?(o.endOfStream(),null===(n=u.current)||void 0===n||n.play()):i.appendBuffer(r.value.buffer);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i.addEventListener("updateend",d),i.appendBuffer(n.value.buffer),null===(r=u.current)||void 0===r||r.play();case 11:case"end":return e.stop()}}),e)})))),e.next=11,x(n);case 11:s=e.sent,i=s.arrayBuffer,d=s.mimeCodec,(p=s.error)?console.error(p):o.addEventListener("sourceopen",(function(){var e=o.addSourceBuffer(d);e.addEventListener("updateend",(function(){})),e.appendBuffer(i)})),l=URL.createObjectURL(o),u.current.src=URL.createObjectURL(o),URL.revokeObjectURL(l);case 17:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[n,r]),(0,d.jsx)("video",{className:"max-h-screen",ref:u,controls:!0,autoPlay:!1,muted:!0,loop:!0,preload:"auto",playsInline:!0,draggable:!1,onLoadStart:o})}}}]);
//# sourceMappingURL=727.8f9df4b5.chunk.js.map